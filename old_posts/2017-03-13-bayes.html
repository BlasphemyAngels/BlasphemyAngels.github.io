<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />

        <script type="text/javascript">
            (function() {
              var hm = document.createElement("script");
              hm.src = "//hm.baidu.com/hm.js?dcee78e565eeaedc76defba5d096b344";
              var s = document.getElementsByTagName("script")[0];
              s.parentNode.insertBefore(hm, s);
            })();

            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-38205696-1']);
            _gaq.push(['_trackPageview']);
            (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>

        <meta name="description" content="" />
        <meta name="viewport" content="width=100%, initial-scale=1" />

        <link rel="shortcut icon" href="/img/owl.ico" />
        <link rel="stylesheet" type="text/css" href="/css/default.min.css" />
    </head>

    <body>

        <div id="music-panel">
    <a id="music-control" onclick="toggleMusicPanel()"></a>
    <div id="music-content">
        <!-- use lazy loading -->
        <!--iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=450 src="http://music.163.com/outchain/player?type=0&id=49176408&auto=0&height=430"></iframe-->
    </div>
</div>


        
        
        <div id="mobile-nav">
          <a href="{ site.url }" onclick="_gaq.push(['_trackEvent', 'ToHome', 'InNavMobile', window.location.pathname]);">首页</a><a href="" onclick="_gaq.push(['_trackEvent', 'ToBlog', 'InNavMobile', window.location.pathname]);">博客</a>
        </div>
        <div class="contentDiv">


<title>从贝叶斯到图模型
    
 - 酒醉久伴</title>




<div class="rotLeft rotTop pageBack"></div>
<div class="rotRight rotTop pageBack"></div>
<div class="container page cn page-post">
    

    <div class="simpleNav">
        <a href="http://zhangwenli.com" class="pageDiv" onclick="_gaq.push(['_trackEvent', 'ToHome', 'InPost', window.location.pathname]);">首页</a>
        <a href="" class="pageDiv" onclick="_gaq.push(['_trackEvent', 'ToBlog', 'InPost', window.location.pathname]);">博客</a>
    </div>

    
    
    <div class="timeago cn" title="+08:00"></div>

    
    <div class="pageTitle">从贝叶斯到图模型</div>

    <div class="tagPanel">
    <a href="/all?tag=bayes" onclick="_gaq.push(['_trackEvent', 'ToTag', 'InPost', window.location.pathname]);"><div class="tag">bayes</div></a><a href="/all?tag=概率图模型" onclick="_gaq.push(['_trackEvent', 'ToTag', 'InPost', window.location.pathname]);"><div class="tag">概率图模型</div></a>
    </div>

    

    <div id="page-view"></div>

    <div class="post-content ">
    <h2 id="正文">正文</h2>

<h3 id="贝叶斯公式">贝叶斯公式</h3>

<p>我们将基本事件空间B分割成n个互斥的的事件空间Bi，那么事件A的概率可以表示为:<br /></p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= P(A)=\sum_{i=1}^{n}P(AB_i)" style="border:none;" /></p>

<p>考虑乘法公式:<br /></p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= P(B_i|A)=\frac{P(AB_i)}{P(A)}" style="border:none;" /></p>

<p>可得:<br /></p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= P(A)=\sum_{i=1}^{n}P(A)P(B_i|A)" style="border:none;" /></p>

<p>这就是全概率公式。<br /></p>

<p>再由条件概率定义:</p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= P(B_i|A)=\frac{P(AB_i)}{P(A)}=\frac{P(A|B_i)P(B_i)}{P(A)}=\frac{P(A|B_i)P(B_i)}{\sum_{i=1}^{n}P(A|B_i)P(B_i)}" style="border:none;" /></p>

<p>这就是著名的贝叶斯定理。</p>

<!--more-->

<h3 id="经典问题">经典问题</h3>

<h4 id="生病问题">生病问题</h4>

<p>加入一种病的患病率是万分之一，医院对这种病的检测准确率是99%，那么你去检测，医生告诉你检测呈阳性，那么你由多大几率真正患病？</p>

<p>设D=1代表患病，D=0代表不患病，C=0代表检测呈隐性，C=1代表检测呈阳性。</p>

<p>那么由题意可知:</p>

<p>P(D=1)=0.0001</p>

<p>P(C=1|D=1)=0.99</p>

<p>P(C=0|D=0)=0.99</p>

<p>则:</p>

<p>P(C=0|D=1)=1-P(C=1|D=1)=0.01</p>

<p>P(C=1|D=0)=1-P(C=0|D=0)=0.01</p>

<p>所以由贝叶斯公式:</p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= P(D=1|C=1)=\frac{P(C=1|D=1)P(D=1)}{\sum_{i=0}^{1}P(C=i|D=i)(P(D=i)}=0.0098" style="border:none;" /></p>

<h4 id="奖品问题">奖品问题</h4>

<p>有三扇门，只有一扇门后面有大奖，参与者可以选择一扇门，然后主持人从余下的两扇门中选择一扇没有奖品的打开，然后再问参与者是否换一扇门。请从数学的角度说明换好还是不换好。</p>

<p>设H=i(i=1,2,3)代表奖品在第i门后，D=i(i=1,2,3)代表主持人打开第i扇门。</p>

<p>不失一般性，不妨设用户打开第一扇门，则：</p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= P(H=1)=P(H=2)=P(H=3)=\frac{1}{3}" style="border:none;" /></p>

<p>P(D=2|H=1)=P(D=3|H=1)=0.5</p>

<p>P(D=2|H=2)=0</p>

<p>P(D=3|H=2)=1</p>

<p>P(D=2|H=3)=1</p>

<p>P(D=3|H=3)=0</p>

<p>由全概率公式：</p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl=P(D=3)=P(D=3|H=1)P(H=1)+P(D=3|H=2)P(H=2)+P(D=3|H=3)P(H=3)=\frac{1}{2}" style="border:none;" /></p>

<p>不妨设主持人打开第三扇门，则由贝叶斯公式：</p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= P(H=1|D=3)=\frac{P(D=3|H=1)P(H=1)}{P(D=3)}=\frac{1}{3}" style="border:none;" /></p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= P(H=2|D=3)=\frac{P(D=3|H=2)P(H=2)}{P(D=3)}=\frac{2}{3}" style="border:none;" /></p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= P(H=3|D=3)=\frac{P(D=3|H=3)P(H=3)}{P(D=3)}=0" style="border:none;" /></p>

<p>所以换得大奖的几率大。</p>

<h3 id="贝叶斯决策">贝叶斯决策</h3>

<p>经过贝叶斯计算出的概率称为后验概率，怎样根据后验概率来决策呢？</p>

<h4 id="风险">风险</h4>

<p>事件在状态wi可能有很多种动作，那么每一种动作所造成的代价称为风险。用风险函数<img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= \lambda(a_j,w_i)" style="border:none;" />代表状态wi做出动作aj所造成的代价，即风险。</p>

<p>动作有很多种，比如在分类问题中，动作可能代表分到某一类去，而代价就是损失函数。</p>

<h4 id="经验损失最小化">经验损失最小化</h4>

<p>前面计算得到的后验概率P(wi|A)代表在一些条件下处于状态wi的概率，那么用它乘以损失函数:</p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= R(w_i,a_j)=\sum_{j=1}^{c}\lambda(w_i,a_j)P(w_i|A)" style="border:none;" /></p>

<p>这就是平均风险，也称为经验风险，找到使它最小化的动作的过程称为经验风险最小化。然后就可以进行决策。即使经验风险达到最小化的动作就是决策结果。</p>

<p>实际中，贝叶斯较难进行经验损失最小化，不过贝叶斯决策理论倒是为我们提供了一个与其他分类器做对比的评价依据，也就是说贝叶斯决策很多情况下是作为对比对象而存在的。</p>

<h3 id="图模型之有向图">图模型之有向图</h3>

<h4 id="背景">背景</h4>

<p>一般来说在用概率模型时，如果拥有了联合概率密度就相当于拥有了上帝视角，可以得到任何想要的东西，但是需要的耗费是指数级的，比如一共有d个变量，每个变量有0和1两个取值，那么就得维护一个2^d的概率表，以备查阅。这样一来耗费太大。基于这个问题的解决，人们提出忽略变量之间的依赖关系，只关心变量之间的核心依赖关系，即定义一个有向无环图，只需记录这些核心关系即可，这样就得到了图模型的有向图方法。</p>

<h4 id="有向无环图">有向无环图</h4>

<p>有向无环图，Directed probabilistic graphical models(DAG)，是指图的结点间是有向边，而且整个图没有环，如下图：</p>

<p><img src="https://github.com/BlasphemyAngels/MarkDownPhotos/blob/master/directgraph.png?raw=true" alt="directgraph" /></p>

<p>图中没有线相连的结点是被假设没有关系的。结点跟它的祖先也是相互独立的，换句话说，结点只跟与它相连的直系父节点有关系。这个假设是根据实际场景的，每个人对它的定义和理解也是不同的。</p>

<p>那么:</p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= P(B,E,A,R,C)=P(B,E,A,R)P(C|B,E,A,R)=P(B,E,A)P(R|B,E,A)P(C|B,E,A,R)" style="border:none;" /></p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= =P(B,E)P(A|B,E)P(R|B,E,A)P(C|B,E,A,R)=P(B)P(E|B)P(A|B,E)P(R|B,E,A)P(C|B,E,A,R)" style="border:none;" /></p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= =P(B)P(E)P(A|B,E)P(R|E)P(C|A)" style="border:none;" /></p>

<p>这就告诉了我们，如果我们有n个变量xi那么这些变量的联合分布律是:</p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= P(x_{1:n})=P(x_1,x_2,...,x_n)=\prod_{i=1}^{n}P(x_i|parents(x_i))" style="border:none;" /></p>

<h4 id="怎么计算">怎么计算？</h4>

<p>假设A有两个取值0和1，那么先求A的分布律：</p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= P(A)=\sum_B\sum_E\sum_C\sum_RP(B,E,A,R,C)" style="border:none;" /></p>

<p>如何计算上面的式子？最简单的方法是四重for循环，但是这样的话时间复杂度太大。那么怎么办呢？想想算法中的动态规划，这里叫做消元。变换求和次序得:</p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= P(A)=\sum_B\sum_E\sum_C\sum_RP(B)P(E)P(A|B,E)P(R|E)P(C|A)" style="border:none;" /></p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= =\sum_B\sum_E\sum_CP(B)P(E)P(A|B,E)P(C|A)\sum_RP(R|E)" style="border:none;" /></p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= =\sum_B\sum_E\sum_CP(B)P(E)P(A|B,E)P(C|A)" style="border:none;" /></p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= =\sum_B\sum_EP(B)P(E)P(A|B,E)\sum_CP(C|A)" style="border:none;" /></p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= =\sum_B\sum_EP(B)P(E)P(A|B,E)" style="border:none;" /></p>

<p>其中最后两步的变换是由于概率的归一性：</p>

<p><img src="http://chart.googleapis.com/chart?cht=tx&amp;chl= \sum_RP(R|E)=\sum_CP(C|A)=1" style="border:none;" /></p>

<p>这里动态规划的思想是通过移动求和次序，消去变量，减少了重复计算。由四重循环变为了两重循环，大大减少了计算量。</p>

<h4 id="naïve-bayes">Naïve Bayes</h4>

<p>最后再讲一下有向概率图的一个特殊情况Naïve Bayes</p>

<p>Naïve Bayes是指下面这种有向概率图:</p>

<p><img src="https://github.com/BlasphemyAngels/MarkDownPhotos/blob/master/naivebayes.png?raw=true" alt="naivebayes" /></p>

<p>上图显示一个分类过程，其实naivebayes第二层结点就是一些分类，从第一层进行的动作就是将数据分到某一个类中，根据上面的理论可以很容易写出上图的联合概率密度，然后再计算第二层given第一层结点的条件概率密度，选择最大的即可进行分类。</p>

<h2 id="参考链接">参考链接:</h2>
<p><a href="http://www.cnblogs.com/elaron/archive/2012/10/29/2745010.html">贝叶斯决策论</a></p>

<p><br /></p>

<p>转载请注明:<a href="[https://BlasphemyAngels.github.io">Artemis的博客</a>–&gt; <a href="https://blasphemyangels.github.io/2017/03/bayes">点此看原文
</a></p>

    </div>

    <div class="clear"></div>

    <a class="tip-btn" href="/tip/" onclick="_gaq.push(['_trackEvent', 'ToTip', 'InPostImg', window.location.pathname]);">
        <img src="/img/tip.png" style="width: 80px" />
    </a>
    <div style="text-align: center; color: #666;">博文对你有帮助吗？如果有的话，要不要<a href="/tip/" onclick="_gaq.push(['_trackEvent', 'ToTip', 'InPost', window.location.pathname]);">送我一本书</a>呢？:heart_eyes:</div>

    

    
    
    
    <hr />

    <!-- <p class="no-indent">微信公众号</p> -->

    <div class="social-share">
        <a class="social-share-element social-twitter" href="https://twitter.com/intent/tweet?text=从贝叶斯到图模型&url=/old_posts/2017-03-13-bayes.html&via=OviliaZhang&hashtags=" target="_blank" title="Share this post on Twitter" onclick="_gaq.push(['_trackEvent', 'Share', 'Twitter', window.location.pathname]);"></a>
        <a class="social-share-element social-facebook" href="https://www.facebook.com/sharer/sharer.php?t=从贝叶斯到图模型&u=/old_posts/2017-03-13-bayes.html" target="_blank" title="Share this post on Facebook" onclick="_gaq.push(['_trackEvent', 'Share', 'Facebook', window.location.pathname]);"></a>
        <a class="social-share-element social-google" href="https://plus.google.com/share?url=/old_posts/2017-03-13-bayes.html" target="_blank" title="Share this post on Google Plus" onclick="_gaq.push(['_trackEvent', 'Share', 'GPlus', window.location.pathname]);"></a>
        <a class="social-share-element social-linkedin" href="http://www.linkedin.com/shareArticle?mini=true&title=从贝叶斯到图模型&url=/old_posts/2017-03-13-bayes.html&source=http%3a%2f%2fzhangwenli.com" target="_blank" title="Share this post on LinkedIn" onclick="_gaq.push(['_trackEvent', 'Share', 'LinkedIn', window.location.pathname]);"></a>
        <a class="social-share-element social-digg" href="http://digg.com/submit?url=/old_posts/2017-03-13-bayes.html&title=从贝叶斯到图模型" target="_blank" title="Share this post on Digg" onclick="_gaq.push(['_trackEvent', 'Share', 'Digg', window.location.pathname]);"></a>
        <a class="social-share-element social-reddit" href="http://reddit.com/submit?url=/old_posts/2017-03-13-bayes.html&title=从贝叶斯到图模型" target="_blank" title="Share this post on Reddit" onclick="_gaq.push(['_trackEvent', 'Share', 'Reddit', window.location.pathname]);"></a>
        <a class="social-share-element social-stumble" href="http://www.stumbleupon.com/submit?url=/old_posts/2017-03-13-bayes.html&title=从贝叶斯到图模型" target="_blank" title="Share this post on StumbleUpon" onclick="_gaq.push(['_trackEvent', 'Share', 'StumbleUpon', window.location.pathname]);"></a>
        <a class="social-share-element social-weibo" href="http://v.t.sina.com.cn/share/share.php?title=来看看+%40qlonny+的博文吧：从贝叶斯到图模型&url=/old_posts/2017-03-13-bayes.html" target="_blank" title="Share this post on Sina Weibo" onclick="_gaq.push(['_trackEvent', 'Share', 'Weibo', window.location.pathname]);"></a>
        <a class="social-share-element social-douban" href="http://shuo.douban.com/!service/share?href=/old_posts/2017-03-13-bayes.html&name=从贝叶斯到图模型" target="_blank" title="Share this post on Dounban" onclick="_gaq.push(['_trackEvent', 'Share', 'Douban', window.location.pathname]);"></a>
    </div>

    <blockquote class="relatedPosts">
        
        
            
            
                
                
                    
                
                    
                
                
            
        
        

        <h4>最近发表</h4>
        <ul>
        
            <li class="relatedPost">
                <a href="/2017/11/07/awk.html" onclick="_gaq.push(['_trackEvent', 'ToPost', 'InRecent', window.location.pathname]);">
                
                
                
                    文本处理三剑客之剑仙awk
                
                </a>
            </li>
        
        </ul>
        <a class="button" href="/all" onclick="_gaq.push(['_trackEvent', 'ToAllPost', 'InPost', window.location.pathname]);">View All Posts</a></p>
    </blockquote>



    <div class="about-author">
    <div class="license">
        <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">
            <img alt="Creative Commons License" style="border-width:0" src="/img/cc.png" />
        </a>
        <div><span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">Every blog post in this site</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://zhangwenli.com" property="cc:attributionName" rel="cc:attributionURL">Lonny</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">CC 3.0 License</a>. </div>
    </div>
    <div class="follow-me">
        <div class="follow-me-txt">Follow <strong>Lonny</strong> at</div>
        <a class="social-share-element social-github" href="https://github.com/BlasphemyAngels" target="_blank" title="Follow me on GitHub" onclick="_gaq.push(['_trackEvent', 'Follow', 'GitHub', window.location.pathname]);"></a>
<a class="social-share-element social-weibo" href="http://weibo.com/plainjane" target="_blank" title="Follow me on Sina Weibo" onclick="_gaq.push(['_trackEvent', 'Follow', 'Weibo', window.location.pathname]);"></a>
<a class="social-share-element social-douban" href="http://www.douban.com/people/ovilia1024/" target="_blank" title="Follow me on Douban" onclick="_gaq.push(['_trackEvent', 'Follow', 'Douban', window.location.pathname]);"></a>
<a class="social-share-element social-so" href="https://stackoverflow.com/users/5597978/innocent" target="_blank" title="Follow me on StackOverflow" onclick="_gaq.push(['_trackEvent', 'Follow', 'StackOverflow', window.location.pathname]);"></a>

    </div>
    <div style="clear: both"></div>
</div>


    <h1>评论</h1>


<div id="disqus_thread"></div>
<script type="text/javascript">
    setTimeout(function() {
        var disqus_shortname = 'lonny';
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    }, 10000);
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


</div>
<div class="rotLeft rotBottom pageBack"></div>
<div class="rotRight rotBottom pageBack"></div>

            <div id="footer-nav">
                | <a href="#">Top</a> |
                <a href="">Blog</a> |
                <a href="http://zhangwenli.com/#ovilia-home">About Me</a> |
                <a href="mailto:me@zhangwenli.com" target="_blank">Email</a> |
                <a href="/feed.xml">RSS</a> |
                <a href="/meta">More</a> |
            </div>

            <div id="footer-follow">
                <a class="footer-follow-element footer-follow-twitter" href="https://twitter.com/OviliaZhang" target="_blank" title="Follow me on Twitter" onclick="_gaq.push(['_trackEvent', 'Follow', 'Twitter', 'Footer']);"></a>
                <a class="footer-follow-element footer-follow-google" href="https://plus.google.com/u/0/112802684720065263732?rel=author" target="_blank" title="Follow me on Google Plus" onclick="_gaq.push(['_trackEvent', 'Follow', 'GPlus', 'Footer']);"></a>
                <a class="footer-follow-element footer-follow-github" href="https://github.com/Ovilia" target="_blank" title="Follow me on GitHub" onclick="_gaq.push(['_trackEvent', 'Follow', 'GitHub', 'Footer']);"></a>
                <a class="footer-follow-element footer-follow-so" href="http://stackoverflow.com/users/760314/ovilia" target="_blank" title="Follow me on StackOverflow" onclick="_gaq.push(['_trackEvent', 'Follow', 'StackOverflow', 'Footer']);"></a>
                <a class="footer-follow-element footer-follow-linkedin" href="http://www.linkedin.com/profile/view?id=148742016" target="_blank" title="Follow me on LinkedIn" onclick="_gaq.push(['_trackEvent', 'Follow', 'LinkedIn', 'Footer']);"></a>
                <a class="footer-follow-element footer-follow-dribbble" href="https://dribbble.com/wenli" target="_blank" title="Follow me on Dribbble" onclick="_gaq.push(['_trackEvent', 'Follow', 'Dribbble', 'Footer']);"></a>
                <a class="footer-follow-element footer-follow-weibo" href="http://weibo.com/plainjane" target="_blank" title="Follow me on Sina Weibo" onclick="_gaq.push(['_trackEvent', 'Follow', 'Weibo', 'Footer']);"></a>
                <a class="footer-follow-element footer-follow-douban" href="http://www.douban.com/people/ovilia1024/" target="_blank" title="Follow me on Douban" onclick="_gaq.push(['_trackEvent', 'Follow', 'Douban', 'Footer']);"></a>
            </div>
        </div>

        <div id="footerDiv">
            <div id="footerImg"></div>
            <div id="footerCnt">
                <div id="footer">
                </div>
            </div>
        </div>

        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script type="text/javascript" src="/js/lazyLoad.js"></script>
        <script type="text/javascript" src="/js/common.js"></script>
    </body>
</html>

